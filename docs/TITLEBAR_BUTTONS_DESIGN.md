# 标题栏按钮布局设计方案

## 📋 需求概述

在自定义标题栏中，将按钮分为两组：
- **左侧组**：刷新、保存、撤销、重做（4个按钮）
- **右侧组**：消息、个人信息（2个按钮）

所有按钮保持同一高度，布局清晰分离。

---

## 🎨 布局设计

### 当前布局结构

```
[图标] [标题]                    [最小化] [最大化] [关闭]
```

### 新布局结构（工具栏区域）

```
[刷新] [保存] [撤销] [重做]  ...  [消息] [个人信息]
  ↑                              ↑
左侧功能按钮组                  右侧用户功能按钮组
```

---

## 🔧 技术实现方案

### 1. UI 布局结构

使用 `QHBoxLayout` 实现左右分离布局：

```cpp
QHBoxLayout *toolbarLayout
├── refreshButton      (左侧，stretch=0)
├── saveButton         (左侧，stretch=0)
├── undoButton         (左侧，stretch=0)
├── redoButton         (左侧，stretch=0)
├── spacer             (中间，stretch=1，自动拉伸)
├── messageButton      (右侧，stretch=0)
└── profileButton      (右侧，stretch=0)
```

### 2. 按钮规格

所有按钮统一规格：
- **尺寸**：32x32 像素（与现有按钮一致）
- **图标大小**：20x20 像素
- **样式**：透明背景，悬停/按下时显示橙色高亮
- **间距**：按钮之间 2 像素间距

### 3. 按钮图标建议

- **消息按钮**：使用 `QStyle::SP_MessageBoxInformation` 或自定义消息图标
- **个人信息按钮**：使用 `QStyle::SP_FileDialogInfoView` 或自定义用户图标

---

## 📝 实现步骤

### 步骤 1：修改 UI 文件 (`src/ui/myform.ui`)

在 `toolbarLayout` 中：
1. 保持现有的 4 个按钮（刷新、保存、撤销、重做）
2. 修改 `spacer` 的 `sizeHint` 为 `0,0`，使其自动拉伸
3. 添加 `messageButton`（消息按钮）
4. 添加 `profileButton`（个人信息按钮）
5. 更新 `stretch` 属性为 `"0,0,0,0,1,0,0"`（4个按钮+spacer+2个按钮）

### 步骤 2：修改头文件 (`src/ui/myform.h`)

添加新按钮的槽函数声明：
```cpp
private slots:
    void handleMessageButtonClicked();
    void handleProfileButtonClicked();
```

### 步骤 3：修改实现文件 (`src/ui/myform.cpp`)

在 `setupFunctionalArea()` 函数中：
1. 设置新按钮的图标
2. 应用相同的样式（使用 `setToolButtonStyle` lambda）
3. 连接按钮的点击信号
4. 可选：设置快捷键（如消息按钮 `Alt+M`，个人信息按钮 `Alt+P`）

---

## 🎯 视觉效果

### 布局示意

```
┌─────────────────────────────────────────────────────────────┐
│ [刷新] [保存] [撤销] [重做]  ...  [消息] [个人信息]         │
└─────────────────────────────────────────────────────────────┘
```

### 按钮状态

- **正常状态**：透明背景
- **悬停状态**：橙色半透明背景 `rgba(255,122,24,0.15)`
- **按下状态**：更深的橙色背景 `rgba(255,122,24,0.30)`

---

## ✅ 设计优势

1. **清晰分组**：功能按钮在左，用户功能在右，符合用户习惯
2. **视觉平衡**：中间 spacer 自动拉伸，保持左右平衡
3. **统一风格**：所有按钮使用相同的样式和尺寸
4. **易于扩展**：未来可以在右侧添加更多用户相关按钮

---

## 🔄 后续扩展建议

如果未来需要添加更多按钮：
- **左侧组**：可以添加更多功能按钮（如导出、导入等）
- **右侧组**：可以添加设置、帮助等用户相关按钮
- 保持左右分离的设计模式

---

---

## ✅ 实现状态

**实现日期**: 2025-01-27

### 已完成的修改

1. ✅ **UI 文件修改** (`src/ui/myform.ui`)
   - 添加 `messageButton`（消息按钮）
   - 添加 `profileButton`（个人信息按钮）
   - 修改 `toolbarSpacer` 的 `sizeHint` 为 `0,0`，使其自动拉伸
   - 更新 `stretch` 属性为 `"0,0,0,0,1,0,0"`（4个左侧按钮+spacer+2个右侧按钮）

2. ✅ **头文件修改** (`src/ui/myform.h`)
   - 添加 `handleMessageButtonClicked()` 槽函数声明
   - 添加 `handleProfileButtonClicked()` 槽函数声明

3. ✅ **实现文件修改** (`src/ui/myform.cpp`)
   - 在 `setupFunctionalArea()` 中设置新按钮的图标
   - 应用统一的按钮样式（32x32 像素，20x20 图标）
   - 连接按钮的点击信号
   - 设置快捷键（消息按钮 `Alt+M`，个人信息按钮 `Alt+P`）
   - 实现两个槽函数（目前显示提示对话框，待后续完善功能）

### 按钮布局

```
[刷新] [保存] [撤销] [重做]  ...  [消息] [个人信息]
  ↑                              ↑
左侧功能按钮组                  右侧用户功能按钮组
```

### 按钮规格

- **尺寸**: 32x32 像素
- **图标大小**: 20x20 像素
- **样式**: 透明背景，悬停/按下时橙色高亮
- **间距**: 按钮之间 2 像素

### 快捷键

- **消息按钮**: `Alt+M`
- **个人信息按钮**: `Alt+P`

---

**设计日期**: 2025-01-27

