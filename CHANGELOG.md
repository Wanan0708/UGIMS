# 📋 变更日志 (CHANGELOG)

所有重要的项目变更都会记录在这个文件中。

格式基于 [Keep a Changelog](https://keepachangelog.com/zh-CN/1.0.0/)，
并且本项目遵循 [语义化版本](https://semver.org/lang/zh-CN/)。

---

## [未发布]

### 新增
- 暂无

### 变更
- 暂无

### 修复
- 暂无

---

## [0.2.0] - 2024-11-27

### 🏗️ 重大架构调整

#### 新增
- ✨ **项目结构重构**: 按功能模块重新组织所有文件
  - 创建 `src/ui/`, `src/widgets/`, `src/tilemap/` 等模块目录
  - 创建 `resources/`, `scripts/`, `third_party/` 资源目录
  - 新增 `docs/PROJECT_STRUCTURE.md` 详细结构说明
  - 新增 `docs/REFACTORING_SUMMARY.md` 重构总结
  - 新增 `scripts/README.md` 脚本使用指南

- 📝 **文档完善**:
  - `docs/DATABASE_SETUP.md` - PostgreSQL完整设置指南
  - `docs/HANG_FIX.md` - 启动卡顿问题修复
  - `docs/启用数据库功能.md` - 数据库功能启用指南

#### 变更
- 🔄 **目录结构**: 
  - 所有源代码移至 `src/` 目录并按模块组织
  - 资源文件统一移至 `resources/` 
  - 脚本工具移至 `scripts/`
  - 文档集中至 `docs/`
  - 第三方依赖移至 `third_party/`

- 📦 **项目配置**:
  - 更新 `CustomTitleBarApp.pro` 所有文件路径
  - 更新 `resources/*.qrc` 资源路径
  - 更新所有源文件中的 `#include` 路径

- 📝 **README优化**:
  - 添加项目结构引用链接
  - 更新快速开始指南

#### 修复
- 🐛 **启动卡顿**: 异步初始化数据库，防止主线程阻塞
- 🔧 **编译错误**: 修复头文件引用路径问题
- ⚡ **连接超时**: PostgreSQL连接超时设置为5秒

#### 移除
- 🗑️ 清理临时文件: `test_minimal.*`, `ui_myform.h`, 日志文件
- 🗑️ 移除根目录的 `Makefile*` 构建产物
- 🗑️ 移除旧的 `启动说明.txt`

---

## [0.1.0] - 2024-11-20

### 🎉 初始版本

#### 新增
- ✨ **管网可视化功能**:
  - PostgreSQL + PostGIS 数据库支持
  - 管线和设施数据模型
  - DAO 数据访问层 (PipelineDAO, FacilityDAO)
  - 图层管理器 (LayerManager)
  - 符号管理器 (SymbolManager)
  - 管线渲染器 (PipelineRenderer)
  - 设施渲染器 (FacilityRenderer)

- 🗺️ **瓦片地图功能**:
  - OpenStreetMap瓦片下载
  - 离线瓦片缓存
  - 多线程下载调度
  - 断点续传支持

- 🎨 **现代化UI**:
  - 自定义标题栏
  - 无边框窗口
  - 蓝色渐变主题
  - 响应式布局

- ⚙️ **核心功能**:
  - 日志系统 (Logger)
  - 配置管理 (Config)
  - 数据库管理器 (DatabaseManager)

#### 技术栈
- Qt 6.8.1
- C++17
- PostgreSQL + PostGIS
- MinGW 64-bit

---

## [0.0.1] - 2024-11-10

### 原型版本

#### 新增
- 基础窗口框架
- 简单地图展示
- 项目初始化

---

## 版本说明

### 版本号规则
遵循 [语义化版本 2.0.0](https://semver.org/lang/zh-CN/)

格式: `主版本号.次版本号.修订号`

- **主版本号**: 不兼容的API修改
- **次版本号**: 向下兼容的功能性新增
- **修订号**: 向下兼容的问题修正

### 变更类型

- **新增**: 新功能
- **变更**: 现有功能的变更
- **弃用**: 即将移除的功能
- **移除**: 已移除的功能
- **修复**: 任何bug修复
- **安全**: 安全性修复

---

## 路线图

### v0.3.0 (计划中)
- [ ] 空间分析功能 (爆管影响分析、连通性分析)
- [ ] 工单管理系统
- [ ] 巡检记录功能
- [ ] 统计报表

### v0.4.0 (计划中)
- [ ] 资产台账管理
- [ ] 高级查询功能
- [ ] 数据导入导出
- [ ] 打印功能

### v0.5.0 (计划中)
- [ ] 移动端支持
- [ ] Web端展示
- [ ] 实时数据同步
- [ ] 多用户权限管理

### v1.0.0 (目标)
- [ ] 完整的管网管理系统
- [ ] 性能优化
- [ ] 完整测试覆盖
- [ ] 用户手册
- [ ] 部署文档

---

## 贡献指南

### 提交规范

使用 [Conventional Commits](https://www.conventionalcommits.org/zh-hans/) 格式:

```
<类型>[可选的作用域]: <描述>

[可选的正文]

[可选的脚注]
```

#### 类型
- `feat`: 新功能
- `fix`: Bug修复
- `docs`: 文档变更
- `style`: 代码格式（不影响代码运行的变动）
- `refactor`: 重构（既不是新增功能，也不是修改bug的代码变动）
- `perf`: 性能优化
- `test`: 增加测试
- `chore`: 构建过程或辅助工具的变动

#### 示例
```
feat(pipeline): 添加管线健康度评估功能

实现了基于管龄、材质、维修记录的综合评分系统

Closes #123
```

---

**感谢所有贡献者！** 🙏

